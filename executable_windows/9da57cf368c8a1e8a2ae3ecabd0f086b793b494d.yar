rule win_meduza_auto
{
	meta:
		author = "Felix Bilstein - yara-signator at cocacoding dot com"
		date = "2023-07-11"
		version = "1"
		description = "Detects win.meduza."
		info = "autogenerated rule brought to you by yara-signator"
		tool = "yara-signator v0.6.0"
		signator_config = "callsandjumps;datarefs;binvalue"
		malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.meduza"
		malpedia_rule_date = "20230705"
		malpedia_hash = "42d0574f4405bd7d2b154d321d345acb18834a41"
		malpedia_version = "20230715"
		malpedia_license = "CC BY-SA 4.0"
		malpedia_sharing = "TLP:WHITE"
		os = "windows"
		filetype = "executable"

	strings:
		$sequence_0 = { ff10 8b75f0 8d4df8 46 8975f0 e8???????? 8b4df4 }
		$sequence_1 = { 8985d0eeffff 898dd4eeffff c785d8e4ffff12b8295c c785dce4ffffd94ef7ef 8b85d8e4ffff 8b8ddce4ffff 8985d8eeffff }
		$sequence_2 = { ff10 e9???????? 6a05 68???????? e9???????? 807e0800 8b0f }
		$sequence_3 = { e9???????? 8d8dc0bdffff e9???????? 8d8df0bdffff e9???????? 8d8df0bdffff e9???????? }
		$sequence_4 = { 8b8d4cf8ffff 898decf2ffff 8985e8f2ffff c78548f8ffff53aa4aea c7854cf8ffff6e523d34 8b8548f8ffff 8b8d4cf8ffff }
		$sequence_5 = { ff75b0 57 ff15???????? 57 85c0 7428 ff15???????? }
		$sequence_6 = { 03c6 c745fc00000000 8d5808 8945f0 0f57c0 c60000 660fd603 }
		$sequence_7 = { 898d2cffffff 8d8d30f6ffff 898528ffffff 8d5101 660fef8d20ffffff 0f298d30f6ffff 0f118530ecffff }
		$sequence_8 = { e9???????? 8d8d28ffffff e9???????? 8b4584 83e002 0f840c000000 836584fd }
		$sequence_9 = { c785d8e4ffffcb46855e c785dce4ffffee6e1f36 8b85d8e4ffff 8b8ddce4ffff c785d8e4ffff88642bdd 8985c0fbffff 898dc4fbffff }

	condition:
		7 of them and filesize <1433600
}
