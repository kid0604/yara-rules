rule win_flawedammyy_auto
{
	meta:
		author = "Felix Bilstein - yara-signator at cocacoding dot com"
		date = "2023-07-11"
		version = "1"
		description = "Detects win.flawedammyy."
		info = "autogenerated rule brought to you by yara-signator"
		tool = "yara-signator v0.6.0"
		signator_config = "callsandjumps;datarefs;binvalue"
		malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.flawedammyy"
		malpedia_rule_date = "20230705"
		malpedia_hash = "42d0574f4405bd7d2b154d321d345acb18834a41"
		malpedia_version = "20230715"
		malpedia_license = "CC BY-SA 4.0"
		malpedia_sharing = "TLP:WHITE"
		os = "windows"
		filetype = "executable"

	strings:
		$sequence_0 = { 8b08 56 52 50 ff511c }
		$sequence_1 = { 00b3854200e5 854200 37 864200 }
		$sequence_2 = { ffd0 803e4d 0f85b2060000 807e015a }
		$sequence_3 = { 0062bf 42 0079bf 42 }
		$sequence_4 = { 8b7510 57 32db 32f6 66c786000100000000 33c0 }
		$sequence_5 = { 83c408 68???????? ffd0 57 56 }
		$sequence_6 = { 0022 8a4200 828a4200bb8a42 00ff }
		$sequence_7 = { 0018 874200 58 874200 }
		$sequence_8 = { 8d45ac 50 8d8548ffffff 50 6a00 6a00 }
		$sequence_9 = { 004bbf 42 0062bf 42 }
		$sequence_10 = { 898d30e5ffff 8b0c8d88ae4100 89b514e5ffff 8a5c0e24 02db d0fb }
		$sequence_11 = { 0000 0404 0404 0404 0401 }
		$sequence_12 = { 6a00 ffd3 4e 75f9 8d45f4 50 }
		$sequence_13 = { 0039 e342 0048e3 42 }
		$sequence_14 = { 002a e342 0039 e342 }
		$sequence_15 = { 50 c745f4981d4100 e8???????? cc 55 8bec 833d????????00 }
		$sequence_16 = { 0f8781000000 ff248dfd243400 881f eb76 ff30 }
		$sequence_17 = { 83c708 c60720 68???????? 57 }
		$sequence_18 = { 8d85d0feffff 68???????? 50 ff15???????? 8b75d8 }
		$sequence_19 = { 837efcff 7518 8b46f8 8b04855c303400 }
		$sequence_20 = { 891d???????? 741f 8b3d???????? 53 }
		$sequence_21 = { 53 8bf0 53 6a02 56 }
		$sequence_22 = { 33c0 8b7df4 8b0c855c303400 c1e705 33d2 }
		$sequence_23 = { 50 ffd7 a3???????? 56 e8???????? }
		$sequence_24 = { ff248580233400 832700 e9???????? 55 e8???????? eb1a 55 }
		$sequence_25 = { ff15???????? 8bf8 8d85ccfdffff 3bf8 77e1 8d85ccfdffff }
		$sequence_26 = { 895df4 8d41de 33db 83f855 0f872affffff 0fb6805a213400 ff2485f6203400 }
		$sequence_27 = { 0f872affffff 0fb6805a213400 ff2485f6203400 8b8614080000 3b45f4 7e03 }
		$sequence_28 = { 8b35???????? eb08 3a4dff 7409 50 ffd6 8a08 }
		$sequence_29 = { 3bc3 8945f8 7431 6aff ff75e8 ff15???????? 8d45f8 }
		$sequence_30 = { 8b4d08 8a0408 a2???????? eb07 c605????????00 c705????????4c403400 ff7508 }
		$sequence_31 = { 8b14957c303400 49 0fafd1 0155fc 46 83c020 }

	condition:
		7 of them and filesize <1350656
}
