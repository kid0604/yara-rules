rule win_etumbot_auto
{
	meta:
		author = "Felix Bilstein - yara-signator at cocacoding dot com"
		date = "2023-07-11"
		version = "1"
		description = "Detects win.etumbot."
		info = "autogenerated rule brought to you by yara-signator"
		tool = "yara-signator v0.6.0"
		signator_config = "callsandjumps;datarefs;binvalue"
		malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.etumbot"
		malpedia_rule_date = "20230705"
		malpedia_hash = "42d0574f4405bd7d2b154d321d345acb18834a41"
		malpedia_version = "20230715"
		malpedia_license = "CC BY-SA 4.0"
		malpedia_sharing = "TLP:WHITE"
		os = "windows"
		filetype = "executable"

	strings:
		$sequence_0 = { 8818 8811 8a00 02c2 0fb6c0 8a8405fcfeffff }
		$sequence_1 = { 02c2 0fb6c0 8a8405fcfeffff 320437 8806 46 }
		$sequence_2 = { 56 57 0fbe38 33f6 33db }
		$sequence_3 = { ff15???????? ffd7 2bc3 3bc6 }
		$sequence_4 = { c745c47272656e c745c874566572 c745cc73696f6e c745d05c5c496e c745d47465726e c745d865742053 }
		$sequence_5 = { 23c1 42 4e 75df 5f }
		$sequence_6 = { 81e1000000f0 7407 8bf9 c1ef18 }
		$sequence_7 = { c745b063726f73 c745b46f66745c c745b85c57696e c745bc646f7773 c745c05c5c4375 }
		$sequence_8 = { 8bf1 0fbe0a c1e004 03c1 8bc8 81e1000000f0 7407 }
		$sequence_9 = { c1ef18 33c7 f7d1 23c1 42 }
		$sequence_10 = { 8bec 53 56 57 8b3d???????? ffd7 8b7508 }
		$sequence_11 = { c745d47465726e c745d865742053 c745dc65747469 c745e06e677300 }
		$sequence_12 = { 8d45f4 6820a10700 50 68???????? 68???????? }
		$sequence_13 = { c745bc646f7773 c745c05c5c4375 c745c47272656e c745c874566572 }
		$sequence_14 = { c645f477 c645f569 c645f66e c645f769 c645f86e }
		$sequence_15 = { aa 6a40 33c0 59 8dbdedfdffff 889decfdffff 895ddc }
		$sequence_16 = { c645c54d c645c653 c645c749 c645c845 }
		$sequence_17 = { c644243778 c644243879 c644243953 c644243a65 885c243b }
		$sequence_18 = { c645d673 c645d720 c645d84e c645d954 }
		$sequence_19 = { 034dec 8a11 8810 8b45f0 83c001 }
		$sequence_20 = { 83c104 3b4d14 7608 83c8ff }
		$sequence_21 = { 8d4a01 83c404 8bd1 c1e902 }
		$sequence_22 = { 8d45f0 50 8bce e8???????? 33c0 }
		$sequence_23 = { 55 8bec 51 51 8d4df8 56 }
		$sequence_24 = { c645fa74 c645fb2e c645fc64 c645fd6c c645fe6c }
		$sequence_25 = { 85ed 741a 3b74245c 0f838c010000 8d442410 }
		$sequence_26 = { c645c16c c645c265 c645c33b c645c420 }
		$sequence_27 = { 8d540964 52 e8???????? 83c404 }
		$sequence_28 = { c645d057 c645d169 c645d26e c645d364 }
		$sequence_29 = { 034df0 8b5508 0355ec 8a02 }
		$sequence_30 = { c645a86e c645a974 c645aa72 c645ab6f c645ac6c c645ad3a }
		$sequence_31 = { 8b45f4 0345f0 8b4d08 034dec 8a11 }
		$sequence_32 = { 80e10f c0e102 c0eb06 02cb }
		$sequence_33 = { c645be74 c645bf69 c645c062 c645c16c }
		$sequence_34 = { c645c33b c645c420 c645c54d c645c653 }
		$sequence_35 = { 8a9405ecfdffff 889000cd4000 eb1c f6c202 7410 8088????????20 8a9405ecfcffff }
		$sequence_36 = { 83c204 3b5514 7608 83c8ff }
		$sequence_37 = { 6a00 68???????? 6a00 6a00 6a00 51 68???????? }
		$sequence_38 = { 8b4d08 83c101 894d08 8b550c 83ea03 }
		$sequence_39 = { 8b8dbcefffff 51 8b9554e6ffff 8b420c ffd0 8b8d9ceaffff 51 }

	condition:
		7 of them and filesize <450560
}
