rule win_3cx_backdoor_auto_alt_3
{
	meta:
		author = "Felix Bilstein - yara-signator at cocacoding dot com"
		date = "2024-10-31"
		version = "1"
		description = "Detects win.3cx_backdoor."
		info = "autogenerated rule brought to you by yara-signator"
		tool = "yara-signator v0.6.0"
		signator_config = "callsandjumps;datarefs;binvalue"
		malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.3cx_backdoor"
		malpedia_rule_date = "20241030"
		malpedia_hash = "26e26953c49c8efafbf72a38076855d578e0a2e4"
		malpedia_version = "20241030"
		malpedia_license = "CC BY-SA 4.0"
		malpedia_sharing = "TLP:WHITE"
		os = "windows"
		filetype = "executable"

	strings:
		$sequence_0 = { 49b8ffffffffffffff0f 4c8bf1 493bc0 0f849f010000 488b4910 }
		$sequence_1 = { 418502 418b01 7409 440fabc0 418901 eba6 }
		$sequence_2 = { 7575 488b7608 4c8b7608 4c3b7610 7443 33c0 }
		$sequence_3 = { 488b8dc0010000 488bc1 4881fa00100000 0f82a30d0000 4883c227 488b49f8 }
		$sequence_4 = { 482bc1 4883c0f8 4883f81f 0f8792090000 e8???????? 4c897580 48c745880f000000 }
		$sequence_5 = { c60601 498b4660 48894608 0fb655c8 488d4dd0 e8???????? 488bc6 }
		$sequence_6 = { 4180fa2d 7502 f7db 4584c9 7529 488b07 48ffc8 }
		$sequence_7 = { 4883fa1f 7305 48ffc2 eb06 33d2 4983c104 }
		$sequence_8 = { 89442448 ffc8 8bf8 410fb68c80023f0300 410fb6b480033f0300 488d1c8d00000000 8d040e }
		$sequence_9 = { e8???????? 90 e8???????? 90 488bd3 488d8d80000000 e8???????? }

	condition:
		7 of them and filesize <585728
}
