rule win_dreambot_auto
{
	meta:
		author = "Felix Bilstein - yara-signator at cocacoding dot com"
		date = "2023-07-11"
		version = "1"
		description = "Detects win.dreambot."
		info = "autogenerated rule brought to you by yara-signator"
		tool = "yara-signator v0.6.0"
		signator_config = "callsandjumps;datarefs;binvalue"
		malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.dreambot"
		malpedia_rule_date = "20230705"
		malpedia_hash = "42d0574f4405bd7d2b154d321d345acb18834a41"
		malpedia_version = "20230715"
		malpedia_license = "CC BY-SA 4.0"
		malpedia_sharing = "TLP:WHITE"
		os = "windows"
		filetype = "executable"

	strings:
		$sequence_0 = { 0b4b18 83671800 894f30 8b4f30 }
		$sequence_1 = { 8b44240c 894320 8b4730 a802 7410 }
		$sequence_2 = { 7414 ff7320 6a00 ff35???????? ffd6 8b44240c }
		$sequence_3 = { e9???????? 8b4730 a840 0f84cd000000 }
		$sequence_4 = { 897b20 8b4320 c6400731 8b742414 8b3e }
		$sequence_5 = { e8???????? 8bf8 3bfb 754f ff7618 }
		$sequence_6 = { ff7320 ff15???????? 85c0 742e 68???????? }
		$sequence_7 = { 56 ff742410 89442418 ff15???????? }
		$sequence_8 = { 7457 53 ff750c 8bfe c7450857000000 }
		$sequence_9 = { 53 68???????? eb54 3bf3 745c }
		$sequence_10 = { ebdd 3bf3 0f8481000000 395d0c }
		$sequence_11 = { ff750c 56 e8???????? e9???????? 3bf3 0f8496000000 }
		$sequence_12 = { 395d0c 0f84ae000000 6a01 ff750c 56 }
		$sequence_13 = { 0f848d000000 6a07 ebdd 3bf3 }
		$sequence_14 = { e9???????? 3bf3 0f84b7000000 395d0c }
		$sequence_15 = { 7520 3bf3 741c 837d0c04 7516 ff7510 }
		$sequence_16 = { 4c8b18 488b542460 4533c9 488bc8 }
		$sequence_17 = { 488b9424a8000000 4533c9 4533c0 ff5028 }
		$sequence_18 = { 493bfd 7464 413bf5 745f 8bd6 488bcf }
		$sequence_19 = { 5f c3 4053 4883ec20 4c8b4108 488bd9 }
		$sequence_20 = { 488d5e10 4533f6 488b0b 2580000000 418d5620 }
		$sequence_21 = { 418d5620 498bcf ff15???????? 4c8bf0 4885c0 }
		$sequence_22 = { 498bcb 492bd0 4803542460 41ff5220 4c8b442460 }
		$sequence_23 = { ebbd 493bfd 0f8481000000 413bf5 }
		$sequence_24 = { 41b904000000 413bf1 7518 8b17 }
		$sequence_25 = { e8???????? 4c8b1d???????? ba0d000000 41834b3401 }
		$sequence_26 = { 0f849b000000 413bf5 0f8492000000 41b803000000 }
		$sequence_27 = { 8bd6 488bcf e8???????? e9???????? 493bfd 0f84b5000000 413bf5 }
		$sequence_28 = { 4c896c2420 e8???????? 4c8b442468 488b0d???????? 33d2 }
		$sequence_29 = { 8b05???????? 413bc5 7528 493bfd 7423 41b904000000 }
		$sequence_30 = { 41b807000000 ebd7 493bfd 0f849b000000 413bf5 }
		$sequence_31 = { 0f84b5000000 413bf5 0f84ac000000 41b807000000 }
		$sequence_32 = { 48c7c101000080 ff15???????? 85c0 7568 4c8d8c24d0000000 4c8d8424c8000000 488d542428 }
		$sequence_33 = { ff15???????? 33d2 89b7184a0000 39971c4a0000 }
		$sequence_34 = { 415c 5f c3 bb01000000 e9???????? }
		$sequence_35 = { 8b05???????? 35fc5585cf 4533c9 4533c0 418bd6 33c9 }
		$sequence_36 = { 81f97acff109 0f840f010000 81f9eb6bfb0d 0f84de000000 }
		$sequence_37 = { 33d2 89442448 ff15???????? 33d2 }
		$sequence_38 = { 4885db 7417 488b0d???????? 4c8bc3 33d2 }
		$sequence_39 = { 69f60d661900 ff75f4 81c65ff36e3c 89750c 8d750c e8???????? 8bf0 }
		$sequence_40 = { 56 8db4083089b9ed 57 8d45f4 50 8b450c 33db }
		$sequence_41 = { 33f6 46 8945f8 85c0 }
		$sequence_42 = { 0f86b2000000 488b4c2450 4c8d442430 488d9424c8000000 e8???????? }
		$sequence_43 = { 483bc3 488b4550 4c8bc3 410f94c1 33d2 4889442420 }
		$sequence_44 = { 8945f8 33ff eb03 8b750c }
		$sequence_45 = { eb03 8b750c ff75f8 69f60d661900 ff75f4 81c65ff36e3c }
		$sequence_46 = { 33d2 3bc2 0f85bd000000 33c0 89942498000000 }
		$sequence_47 = { c3 6a00 6800004000 6a00 ff15???????? a3???????? 85c0 }
		$sequence_48 = { 817424105085b8ed 33ff 47 57 be???????? 56 8d542418 }
		$sequence_49 = { 8b450c 33db 895dfc e8???????? 8945f8 33ff }
		$sequence_50 = { 8945f8 85c0 7551 ff33 50 6810040000 }
		$sequence_51 = { 488b572c 4533c9 448bc0 498bcd ff5320 498b4500 4489742478 }
		$sequence_52 = { 0f84ca010000 8b424c a801 0f840f010000 8b424c }
		$sequence_53 = { 57 4883ec20 8b05???????? 8364243800 }
		$sequence_54 = { 488d4c2450 4533c9 e8???????? 488b5c2428 }
		$sequence_55 = { 33c0 89942498000000 899424a8000000 8984249c000000 }
		$sequence_56 = { 3decc7eea6 0f84e8000000 3d0470a8c4 0f8486000000 }
		$sequence_57 = { 6810040000 ff15???????? 8945fc 85c0 741a 6804010000 8d4f10 }
		$sequence_58 = { 488b0d???????? 4d8bc4 33d2 ff15???????? 488bf8 }
		$sequence_59 = { 4883f8ff 488bf8 7445 488d842488000000 }
		$sequence_60 = { 3decc7eea6 0f8459010000 3d0470a8c4 0f84dd000000 }
		$sequence_61 = { 3bc7 0f85dc000000 57 ff7618 }
		$sequence_62 = { 4c8bc6 ff15???????? 488bd8 493bc7 }
		$sequence_63 = { f605????????04 740e 44893d???????? 44893d???????? 488d442440 4c8d4c2440 4c8d442440 }
		$sequence_64 = { ff7508 46 e8???????? 85c0 0f845d030000 53 }
		$sequence_65 = { 4d3bef 7415 498bd5 4883c9ff ff15???????? }
		$sequence_66 = { 493bc5 742f 488d4810 ff15???????? }
		$sequence_67 = { 50 e8???????? 8bf0 8975f4 3bf7 0f8487000000 }
		$sequence_68 = { 40 50 e8???????? 8945f0 3bc7 }
		$sequence_69 = { 5f 5b 8be5 5d c20400 8325????????00 6a00 }
		$sequence_70 = { e9???????? 6800100000 e8???????? 8945f8 }
		$sequence_71 = { 8b45fc 0fb700 8bc8 81e100f00000 }
		$sequence_72 = { 7406 890d???????? 840d???????? 7405 e8???????? }
		$sequence_73 = { 59 59 3bf3 7469 83c614 3b75f8 7361 }
		$sequence_74 = { 4885c9 7405 e8???????? 4883c428 c3 4053 }
		$sequence_75 = { e8???????? a1???????? 83c40c 83c01e 50 ffd7 }
		$sequence_76 = { eb34 488d0595d6ffff 4885c0 7428 8b7b10 }
		$sequence_77 = { 8b9314170000 83432801 b910000000 8d42f3 2aca }
		$sequence_78 = { 4883c12e ff15???????? 448a1f 443a5b08 7315 488b0b 410fb6c3 }
		$sequence_79 = { 488bce ff15???????? 488b0d???????? 4883c12e }
		$sequence_80 = { 33d2 e8???????? 44892d???????? 33c9 44892d???????? e8???????? 488bcf }
		$sequence_81 = { c9 c20800 55 8bec 81ec1c010000 8d4807 }
		$sequence_82 = { 89542464 ffd3 56 57 e8???????? }
		$sequence_83 = { 488b15???????? 4c8d442468 48c7c101000080 ff15???????? }
		$sequence_84 = { 50 ff742438 8b442440 e8???????? 8b0d???????? 89442414 83c136 }
		$sequence_85 = { 66b90100 4889442420 e8???????? 3bc3 0f859b000000 }
		$sequence_86 = { a1???????? 83c01e 50 ffd6 }
		$sequence_87 = { 488b0d???????? 448be0 f0834156ff 85c0 }
		$sequence_88 = { 5d c3 0fb708 6683f902 751c }
		$sequence_89 = { e9???????? 83e908 74eb 2bcb 0f84fa000000 2bcb }
		$sequence_90 = { ffd7 8b1d???????? 6a3a b8???????? }
		$sequence_91 = { c3 33c0 483bc8 7458 488b5128 483bd0 }
		$sequence_92 = { 8d4604 66d3e0 66098310170000 8d4103 }
		$sequence_93 = { 83c01e 50 ff15???????? c20400 55 8bec 83ec18 }
		$sequence_94 = { ff15???????? eb0b b90a000000 ff15???????? 4c8b1d???????? 418b4356 }
		$sequence_95 = { 5b c20800 51 53 57 6884000000 e8???????? }
		$sequence_96 = { e8???????? 488b0d???????? 4883c12e ff15???????? 8ac3 }
		$sequence_97 = { 0f8e2a040000 8a05???????? 4238042b 7521 448bc2 4963ce }
		$sequence_98 = { e8???????? 8bd8 a1???????? 83c036 }
		$sequence_99 = { a1???????? 8b4036 85c0 75ec 8b442404 53 }
		$sequence_100 = { ff15???????? 8bd8 413bde 0f8517030000 f605????????04 740e 44893d???????? }
		$sequence_101 = { 50 ff15???????? a1???????? 33c9 83c036 41 f00fc108 }
		$sequence_102 = { ffb72c080000 e8???????? 5e 5d 5b c3 eb10 }
		$sequence_103 = { 83839c000000ff 397818 0f852ffcffff 33c0 }
		$sequence_104 = { 0f84a0010000 3bfe 0f8498010000 ff742418 ff15???????? }
		$sequence_105 = { e9???????? 83f916 0f8fa7080000 0f8415080000 }
		$sequence_106 = { 8d4710 e8???????? 83a78c00000000 33c0 c3 51 e8???????? }
		$sequence_107 = { 68???????? c74424340c000000 895c243c e8???????? }
		$sequence_108 = { e8???????? 85c0 0f849d010000 395c244c 7407 68???????? }
		$sequence_109 = { 32ec e25e 37 91 da885a791c0a 99 }
		$sequence_110 = { 83c004 41 3bc2 7cf4 }
		$sequence_111 = { 894de4 894df4 894df8 894dec c745e0e724be03 8945d8 751b }
		$sequence_112 = { 6a01 e8???????? 85c0 0f8534030000 8b3d???????? 813d????????ca52a99a 8b4c2420 }
		$sequence_113 = { 1110 81c13231038d 848698046e99 16 }
		$sequence_114 = { 8bd8 ffd7 ff75e8 ffd7 eb08 }
		$sequence_115 = { 740f 8b4e08 c745e8a8200410 894dec eb07 8b06 8945ec }
		$sequence_116 = { 8b35???????? 6a00 ffd6 ff742414 ff742414 57 e8???????? }
		$sequence_117 = { 57 35fa446809 33ff 57 50 8d45f8 50 }

	condition:
		7 of them and filesize <802816
}
