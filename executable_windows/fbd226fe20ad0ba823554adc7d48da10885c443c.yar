import "pe"

rule henry217_opcode
{
	meta:
		description = "Detect the risk of Ransomware henry217 Rule 2"
		hash1 = "8dd3fba314bdef96075961d8e0ee3a45d5a3030f89408d2b7f9d9fa5eedc66cd"
		os = "windows"
		filetype = "executable"

	strings:
		$opcode1 = {1B300400A9000000020000111F208D270000010A281800000A03068E696F1900000A6F1A00000A06068E69281B00000A1F108D270000010B281800000A04078E696F1900000A6F1A00000A07078E69281B00000A140C281C00000A0D731D00000A130411040906076F1E00000A17731F00000A130511050216028E696F2000000A11056F2100000A11046F2200000A0CDE0C11052C0711056F2300000ADCDE0C11042C0711046F2300000ADCDE0526140CDE00082A00000001280000020069001D86000C00000000020057003D94000C000000000000500052A2000513000001}
		$opcode2 = {1B3005004F01000003000011036F2400000A0A16}

	condition:
		uint16(0)==0x5a4d and filesize <2000KB and (1 of them ) and pe.imphash()=="f34d5f2d4577ed6d9ceec516c1f5a744"
}
