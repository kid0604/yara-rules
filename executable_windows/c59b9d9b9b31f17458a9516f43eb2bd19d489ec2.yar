import "pe"

rule APT_Downloader_Win64_REDFLARE_1
{
	meta:
		date_created = "2020-11-27"
		date_modified = "2020-11-27"
		md5 = "9529c4c9773392893a8a0ab8ce8f8ce1"
		rev = 2
		author = "FireEye"
		description = "Detects APT Downloader Win64 REDFLARE variant 1"
		os = "windows"
		filetype = "executable"

	strings:
		$const = "Cookie: SID1=%s" fullword
		$http_req = { 00 00 08 80 81 3D [4] BB 01 00 00 75 [1-10] 00 00 80 00 [1-4] 00 10 00 00 [1-4] 00 20 00 00 89 [6-20] 00 00 00 00 [6-20] 00 00 00 00 [2-10] 00 00 00 00 45 33 C9 [4-20] 48 8D 15 [4] 48 8B 0D [4] FF 15 [4-50] B9 14 00 00 00 E8 }

	condition:
		( uint16(0)==0x5A4D) and ( uint32( uint32(0x3C))==0x00004550) and ( uint16( uint32(0x3C)+0x18)==0x020B) and all of them
}
